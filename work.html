<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Welcome to Firebase Hosting</title>

    <!-- update the version number as needed -->
    <script defer src="/__/firebase/4.6.2/firebase-app.js"></script>
    <!-- include only the Firebase features as you need -->
    <script defer src="/__/firebase/4.6.2/firebase-auth.js"></script>
    <script defer src="/__/firebase/4.6.2/firebase-database.js"></script>
    <script defer src="/__/firebase/4.6.2/firebase-messaging.js"></script>
    <script defer src="/__/firebase/4.6.2/firebase-storage.js"></script>
    <!-- initialize the SDK after all desired features are loaded -->
    <script defer src="/__/firebase/init.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    
  </head>
  <body>
    <div class="bookshelf">
    <div class="overlay">
      <div class="deskmenuSearch">
      <nav class="searchNav">
            <li><a class="deskbtn" href="#"><img src="whitemenu.png"/></a>
                <ul>
                    <li><a href="index.html"> Home </a></li>
            <li><a href="search.html"> Search </a></li>
            <li><a href="about.html"> About </a></li>
            <li><a href="contact.html"> Contact </a></li>
                </ul>
              </li>
      </nav>
    </div>
      <h1> SEARCH </h1>
      <form>
  INFO1 : <input type="text" id="keywords" placeholder="Search by Title, Author, ISBN, etc." onkeydown = "if (event.keyCode == 13)
                        document.getElementById('save_button' && 'table').click()"    ><br>
  <!-- <input type ="text" id="info1"> -->
  <button id="save_button" style="visibility: hidden;" >SEARCH</button>
  <button id="load_button" style="visibility: hidden;">load</button>
</form>
  <p id="print">Change</p>

  <script src="https://www.gstatic.com/firebasejs/4.6.2/firebase.js"></script>

  <section class = "tableHolder">
        <table>
          <tr>
            <th>Source</th>
            <th>Title</th>
            <th>Author</th>
            <th>Read</th>
            <th>Download</th>
          </tr>
        </table>
        <table id="myTable">
        <!--  <tr>
            <td>Row1 cell1</td>
            <td>Row1 cell2</td>
            <td>Row1 cell2</td>
            <td>Row1 cell2</td>
            <td>Row1 cell2</td>
          </tr> -->
          
        </table>
      </section>
<br>
<!--
<button id="table" onclick="myFunction()">Try it</button>
<script>
function myFunction() {
    var table = document.getElementById("myTable");
    var row = table.insertRow(0);
    var cell1 = row.insertCell(0);
    var cell2 = row.insertCell(1);
    cell1.innerHTML = "NEW CELL1";
    cell2.innerHTML = "NEW CELL2";
}
</script> -->

<script>
  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyBcHTaUBohlQ3rKkz7HTYAssR1TbaPuqfc",
    authDomain: "book-spider.firebaseapp.com",
    databaseURL: "https://book-spider.firebaseio.com",
    projectId: "book-spider",
    storageBucket: "book-spider.appspot.com",
    messagingSenderId: "13688800516"
  };
  firebase.initializeApp(config);

  var rootRef = firebase.database().ref().child('infos');

  $('#save_button').click(function(){
      rootRef.set({
        keywords:$('#keywords').val()
      });

  });
var ref = firebase.database().ref('results/');
ref.on("child_added", function(once){
ref.once('value', function(snapshot) {
    snapshot.forEach(function(userSnapshot){
      var list = userSnapshot.val();
      var get = list[0];
      var title = get.title;
      var author = get.author;
      var downloadLink = get.download;
      var readLink = get.read;
      document.getElementById("print").innerHTML = title;
      console.log(title);
      console.log(downloadLink);
      console.log(readLink);
      var table = document.getElementById("myTable");
      var row = table.insertRow(0);
      var cell1 = row.insertCell(0);
      var cell2 = row.insertCell(1);
      var cell3 = row.insertCell(2);
      var cell4 = row.insertCell(3);
      var cell5 = row.insertCell(4);
      cell1.innerHTML = "BookRix";
      if(title === ""){
        document.getElementById("myTable").deleteRow(0);
      }
      else{
      cell2.innerHTML = title;
      }
      cell3.innerHTML = author;
      if(downloadLink == "https://www.bookrix.comundefined"){
        downloadLink = "unavailable";
      }
      else{
        var str = "Download";
        var result = str.link(String(downloadLink));
        cell5.innerHTML = result;
      }
      if(readLink == "https://www.bookrix.comundefined" ){
        readLink = "unavailable";
      }
      if(readLink == "https://www.bookrix.com#" ){
        readLink = "unavailable";
      }
      else{
        var str = "Read";
        var result = str.link(String(readLink));
        cell4.innerHTML = result;
      }
     

      //}
      
      //var items = list['title'];
    
});
});
});





/* ref.on("value", function(snapshot) {
  var data = snapshot.val();
  var next = data.child();
  var fin = next.child();
  document.getElementById("print").innerHTML = fin.title;
  console.log(fin.title);
}, function (error) {
  console.log("Error:" + error.code);
   });

var ref = firebase.database().ref().child('test/');

ref.on("value", function(snapshot) {
  var data = snapshot.val();
  document.getElementById("print").innerHTML = data.color;
  console.log(data.color);
}, function (error) {
  console.log("Error:" + error.code);
   });

*/





/*keyRef.on("child_added", function(data, prevChildKey) {
   var newKey = data.val();
   console.log("title: " + newKey.title);
   console.log("read: " + newKey.read);
   console.log("title: " + newKey.download);
});

  /*$('#table').click(function(){
      rootRef.on('value',function(snapshot){
        $('cell1').val(snapshot.child('keywords').val());
        $('cell2').val(snapshot.child('keywords').val());
      })
  })*/



</script>


    <script>
      document.addEventListener('DOMContentLoaded', function() {
        // // ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
        // // The Firebase SDK is initialized and available here!
        //
        // firebase.auth().onAuthStateChanged(user => { });
        // firebase.database().ref('/path/to/ref').on('value', snapshot => { });
        // firebase.messaging().requestPermission().then(() => { });
        // firebase.storage().ref('/path/to/ref').getDownloadURL().then(() => { });
        //
        // // ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥

        try {
          let app = firebase.app();
          let features = ['auth', 'database', 'messaging', 'storage'].filter(feature => typeof app[feature] === 'function');
          document.getElementById('load').innerHTML = `Firebase SDK loaded with ${features.join(', ')}`;
        } catch (e) {
          console.error(e);
          document.getElementById('load').innerHTML = 'Error loading the Firebase SDK, check the console.';
        }
      });
    </script>

   



  </body>
</html>
